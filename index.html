<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nosso Universo</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,400&family=Montserrat:wght@200;300&family=Poppins:ital,wght@0,300;0,400;1,300&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #050510;
            --star-white: #ffffff;
            --star-gold: #fbbf24;
            --text-main: rgba(255, 255, 255, 0.9);
            --transition-soft: all 1.5s cubic-bezier(0.22, 1, 0.36, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body, html {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: var(--bg-color);
            font-family: 'Montserrat', sans-serif;
            touch-action: none;
        }

        #canvas {
            display: block;
            cursor: grab;
            transition: filter 1s ease;
            width: 100%;
            height: 100%;
        }
        
        #canvas:active {
            cursor: grabbing;
        }

        /* O menu, overlay e essas frescuras KKKKKKKK */
        #menu-overlay {
            position: fixed;
            inset: 0;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(5, 5, 16, 0.85);
            backdrop-filter: blur(20px);
            transition: opacity 2s ease, visibility 2s;
            padding: 2rem;
        }

        .menu-content {
            max-width: 700px;
            text-align: center;
            color: white;
            position: relative;
        }

        .menu-text {
            font-family: 'Poppins', sans-serif;
            font-size: 1.1rem;
            line-height: 1.8;
            font-weight: 300;
            margin-bottom: 2.5rem;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInText 2s forwards 0.5s;
        }

        .start-btn {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 1.2rem 3.5rem;
            font-family: 'Montserrat', sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.3em;
            font-size: 0.75rem;
            cursor: pointer;
            transition: var(--transition-soft);
            border-radius: 4px;
            outline: none;
            touch-action: manipulation;
            position: relative;
            z-index: 10;
        }

        .start-btn:hover, .start-btn:active {
            background: white;
            color: black;
            box-shadow: 0 0 40px rgba(255, 255, 255, 0.3);
        }

        /* Os planetas, mas todos sabemos que a terra é plana */
        .planet {
            position: absolute;
            border-radius: 50%;
            pointer-events: none;
            z-index: -1;
            filter: blur(2px);
            opacity: 0.4;
        }
        .p1 { width: 120px; height: 120px; background: radial-gradient(circle at 30% 30%, #3a4b8a, #050510); top: -180px; right: -120px; animation: float 12s infinite ease-in-out; }
        .p2 { width: 60px; height: 60px; background: radial-gradient(circle at 30% 30%, #8a6b3a, #050510); bottom: -100px; left: -80px; animation: float 18s infinite ease-in-out reverse; }

        @keyframes fadeInText {
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(20px, -30px); }
        }

        /* Elemntos da UI - HUD, player etc */
        .hud {
            position: fixed;
            pointer-events: none;
            color: rgba(255, 255, 255, 0.4);
            z-index: 10;
            transition: opacity 1s ease;
        }

        /* player que tava enchendo o saco bugando */
        .music-player {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%) translateY(20px);
            z-index: 20;
            display: flex;
            flex-wrap: nowrap; 
            align-items: center;
            gap: 15px;
            background: rgba(15, 15, 25, 0.85); 
            backdrop-filter: blur(15px);
            padding: 12px 24px;
            border-radius: 50px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            transition: opacity 1s ease, transform 0.5s ease;
            pointer-events: auto;
            touch-action: none;
            opacity: 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            width: auto;
            max-width: 90%;
        }

        .music-player.visible {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        .controls-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .play-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 44px; 
            height: 44px;
            border-radius: 50%;
            background: rgba(255,255,255,0.05);
            transition: all 0.2s;
            touch-action: manipulation;
            flex-shrink: 0;
        }

        .play-btn:active {
            transform: scale(0.95);
            background: rgba(255,255,255,0.1);
        }

        .play-btn svg {
            width: 24px;
            height: 24px;
            fill: var(--star-gold); 
        }

        .track-info {
            display: flex;
            flex-direction: column;
            min-width: 100px;
            margin-right: 10px;
        }

        .track-name {
            font-family: 'Montserrat', sans-serif;
            font-size: 0.85rem;
            color: white;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 150px;
        }

        .track-artist {
            font-family: 'Montserrat', sans-serif;
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.6);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 150px;
        }

        /* Equalizador KKKKKKKKKKKKKKKKKKKKKKK */
        .equalizer {
            display: flex;
            gap: 3px;
            height: 15px;
            align-items: flex-end;
            margin-right: 5px;
        }
        
        .bar {
            width: 3px;
            background: var(--star-gold);
            animation: equalize 1s infinite ease-in-out;
        }
        .bar:nth-child(1) { animation-duration: 0.8s; height: 60%; }
        .bar:nth-child(2) { animation-duration: 1.1s; height: 80%; }
        .bar:nth-child(3) { animation-duration: 0.9s; height: 40%; }

        .equalizer.paused .bar {
            animation-play-state: paused;
            height: 3px !important;
            transition: height 0.3s ease;
        }

        @keyframes equalize {
            0%, 100% { height: 20%; }
            50% { height: 100%; }
        }

        /* Aumenta e diminui la ele */
        .volume-control {
            display: flex;
            align-items: center;
            gap: 8px;
            border-left: 1px solid rgba(255,255,255,0.1);
            padding-left: 15px;
        }

        .volume-icon {
            width: 16px;
            height: 16px;
            fill: rgba(255,255,255,0.6);
        }

        input[type=range] {
            -webkit-appearance: none;
            width: 80px;
            height: 4px;
            background: rgba(255,255,255,0.2);
            border-radius: 2px;
            outline: none;
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 14px;
            height: 14px;
            background: var(--star-gold);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(251, 191, 36, 0.5);
        }

        input[type=range]::-moz-range-thumb {
            width: 14px;
            height: 14px;
            background: var(--star-gold);
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        #text-overlay {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 5;
            will-change: filter;
        }

        .quote-label {
            position: absolute;
            width: 300px;
            font-family: 'Cormorant Garamond', serif;
            color: var(--text-main);
            font-size: 1.25rem;
            line-height: 1.6;
            font-style: italic;
            opacity: 0;
            transition: opacity 1.5s ease;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.8);
            text-align: center;
            pointer-events: none; /* Garante que o texto não atrapalhe o toque */
        }

        .quote-label.visible { opacity: 1; }
        .quote-label.celestial-title { 
            font-weight: 600; 
            font-size: 1.6rem;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            margin-bottom: 8px;
            display: block;
            color: var(--star-gold);
        }

        .hidden { opacity: 0 !important; visibility: hidden !important; }
        
        @media (max-width: 768px) {
            .menu-text { font-size: 0.95rem; }
            .quote-label { width: 80vw; font-size: 1.1rem; }
            .title-box h1 { font-size: 1.2rem; }
            
         
            .music-player { 
                bottom: 20px; 
                width: 92%; 
                padding: 10px 15px;
                justify-content: space-between;
                gap: 10px;
            }
            .track-name { max-width: 100px; font-size: 0.8rem; }
            .play-btn { width: 40px; height: 40px; }
            .volume-control { padding-left: 10px; }
            input[type=range] { width: 60px; }
        }
    </style>
</head>
<body>

    
    <div id="menu-overlay">
        <div class="menu-content">
            <div class="planet p1"></div>
            <div class="planet p2"></div>
            <p class="menu-text">
                Duda, essas frases eu guardo faz uns 2 anos e, nenhuma foi gerada por IA, todas eu fui fundo pesquisando e reunindo as melhores. E eu queria dedicar todas elas pra você nesse site que eu codei, espero que goste... <br><br>
                Aliás, algumas são bem intensas, mas o Gabriel do futuro iria te dedicá-las em algum momento de qualquer jeito.<br>
                Um abraço do seu amigão! <3
            </p>
            <button class="start-btn" id="start-btn">Entrar no Universo</button>
        </div>
    </div>

   
    <audio id="bg-music" loop>
        <source src="musica/MUSICADELA.mp3" type="audio/MPEG">
    </audio>

    <!-- Player Customizado com Volume XD -->
    <div class="music-player" id="music-player">
        
        <div class="controls-left">
            <button class="play-btn" id="toggle-music" aria-label="Tocar ou Pausar Música">
                
                <svg id="play-icon" viewBox="0 0 24 24">
                    <path d="M8 5v14l11-7z"/>
                </svg>
                
                <svg id="pause-icon" viewBox="0 0 24 24" style="display: none;">
                    <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
                </svg>
            </button>

            <div class="equalizer paused" id="equalizer">
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
            </div>

            <div class="track-info">
                <span class="track-name">O Céu Explica Tudo</span>
                <span class="track-artist">Henrique & Juliano</span>
            </div>
        </div>

        <div class="volume-control">
            <svg class="volume-icon" viewBox="0 0 24 24">
                <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
            </svg>
            <input type="range" id="volume-slider" min="0" max="1" step="0.05" value="0.4">
        </div>

    </div>

    <div id="text-overlay"></div>
    <canvas id="canvas"></canvas>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d', { alpha: false });
        const textOverlay = document.getElementById('text-overlay');
        const menu = document.getElementById('menu-overlay');
        const bgMusic = document.getElementById('bg-music');
        const musicPlayer = document.getElementById('music-player');
        const toggleMusicBtn = document.getElementById('toggle-music');
        const playIcon = document.getElementById('play-icon');
        const pauseIcon = document.getElementById('pause-icon');
        const equalizer = document.getElementById('equalizer');
        const startBtn = document.getElementById('start-btn');
        const volumeSlider = document.getElementById('volume-slider');

        // volume começa assim
        bgMusic.volume = 0.4;
        volumeSlider.value = 0.4;

        // as frases pra minha princesa 
        const QUOTES = [
            "Dizem que um homem só se apaixona uma única vez, isso de fato é uma mentira, pois me apaixonei no brilho de seus olhos, no teu mais belo sorriso, e em tua mais doce voz.",
            "Você é tão linda que a lua e o sol se revezam para contemplar sua beleza.",
            "Você é a resposta de todas as minhas orações",
            "Existem 7.000 idiomas, 650.000 palavras no mundo e, no entanto, toda vez que vejo você, ainda fico totalmente sem palavras.",
            "Eu só pensei que havia dois tipos de amor, aquele pelo qual você mataria e aquele pelo qual você morreria, mas ver você me fez perceber que você era o tipo de amor pelo qual eu viveria.",
            "Toda vez que desvio o olhar de você, me encontro procurando por você.",
            "Se eu pudesse mudar as coisas, mudaria a lua para seus olhos e o sol para seu sorriso, então me deitaria com seu olhar e me levantaria com seu sorriso.",
            "Eles podem dizer que você é o Sol que ilumina tudo em seu caminho, mas para mim você é a Lua, que ilumina a escuridão nos momentos mais carentes.",
            "Seus olhos ganhariam um espaço no céu, pois eles brilham mais do que as próprias estrelas.",
            "A lua é a beleza de Deus, o sol é o poder de Deus e você é sua mais bela criação.",
            "Quando o sol nasce, você não tem sombra, porque não há nada que possa replicar sua beleza.",
            "Seus olhos são como nuvens, pois mesmo quando eles enchem de tristeza e afogam a terra, eles pintam o céu com uma beleza inimaginável.",
            "Existem incontáveis estrelas no universo, mas a única que me encanta com seu brilho só pode ser encontrada na vastidão dos seus olhos.",
            "Espero que, com cada oração sussurrada, algum dia, em breve, nossos caminhos na verdade sejam compartilhados. Até então, meu amor, em sonhos eu vou te abraçar e valorizar cada momento, mesmo que eles desapareçam.",
            "Tenho conversas noturnas com a lua, ela me fala do sol e eu falo de você.",
            "O elogio mais belo e profundo nunca será suficiente pra você, pois sua beleza ultrapassa todos os meios de pronúncia.",
            "Sua beleza me surpreende pois ao colocar meus olhos em você é como receber uma recompensa não destinada a mim ou a qualquer outra pessoa.",
            "Eu observei as estrelas por horas entediado, mas quando olhei em seus olhos nem pude ver o tempo passar, tudo parou, exceto o meu encanto por você.",
            "Eu caminharia no mesmo deserto, passaria pelo mesmo pântano, nadaria nos mesmos mares se me falassem que no fim do caminho, eu te encontraria.",
            "Se você for o sol, eu serei Ícaro, um tolo fadado a cair e queimar antes mesmo de chegar até você. Mesmo em asas de cera, eu voaria em sua direção.",
            "Deus nos deu dois ouvidos, dois olhos, duas pernas e duas mãos, mas Ele só nos deu um coração, e Ele queria que eu te encontrasse e te dissesse, você é o segundo.",
            "Seus olhos são como um labirinto, quando olho para eles me perco, descubro que não quero sair daquele labirinto.",
            "Se eu ficasse cego no momento em que colocasse meus olhos em você, eu não lamentaria, pois naquele momento eu já tinha visto toda a beleza que este mundo tinha para mostrar.",
            "Os girassóis devem se voltar para você, pois confundem sua beleza brilhante com o sol.",
            "Há tantas estrelas no céu noturno, mas há uma que brilha e faisca mais, como aquela vez em que te vi brilhando e brilhando na multidão.",
            "Não vejo por que os astronautas vão ao espaço para que possam ver o mundo, vejo o meu só de olhar para você.",
            "As estrelas tinham tanta inveja de como você era brilhante que forçaram o sol a cair para sua morte apenas para serem vistas, mas você as ofuscou todas as vezes.",
            "Meus sonhos se transformam em pesadelos no momento em que acordo, mas você na minha frente me faz pensar se estou sempre sonhando.",
            "Um dia lembro-me de sentir meu coração cair e congelar atordoado com a obra-prima de Deus. Percebi que estava olhando para você.",
            "Van Gogh teria tido inveja de mim, porque ele pintou a noite estrelada apenas uma vez, e eu consigo ver as mais belas estrelas somente olhando em teus olhos.",
            "Assim como a noite é estrelada, você possui uma imensidão de estrelas no olhar. Você é admirável como os girassóis. Van Gogh ficaria fascinado, pois você é a junção das suas belas obras.",
            "Pintores buscaram retratar a perfeição e não conseguiram, mas eu vejo o que tanto buscaram em seus olhos.",
            "Van Gogh não conseguiu fazer as mais belas estrelas, nem a mais bela constelação. Isso só aconteceu porque ele não conhecia a existência dos seus olhos.",
            "Descobri o motivo da tristeza do velho homem que Van Gogh retrata no quadro “Sorrowing Old Man”. O motivo de sua tristeza foi o fato de ele nunca poder admirar uma garota igual você.",
            "Van Gogh disse que a visão das estrelas o fazia sonhar, mas se ele visse as estrelas que eu vejo em seus olhos, ele nunca mais iria querer acordar.",
            "Van Gogh só conseguiu retratar o amarelo nos girassóis porque ele não viu o arco-íris que você transmite no seu olhar.",
            "Van Gogh só amou as estrelas porque ele não viu a constelação do seu olhar.",
            "Se você morrer, eu ficaria com inveja da terra que pode te abraçar por toda a eternidade.",
            "Eu queria ser uma de suas lágrimas, para poder nascer em seus olhos, escorrer pela sua bochecha e morrer em seus lábios.",
            "Se eu me atrevesse a gritar ao mundo o quanto eu te amo, eu simplesmente sussurraria isso em seus ouvidos. Pois o meu mundo é você.",
            "Dizem que as pessoas só podem estar em um lugar de cada vez, mas isso é errado, pois você está em minha mente e em meu coração ao mesmo tempo.",
            "Durante séculos, os humanos usaram as estrelas para guiá-los em suas jornadas. Mas toda vez que olho em seus olhos, me perco.",
            "Eu não te amo com meu coração ou mente. Eu te amo com minha alma, caso minha mente esqueça e meu coração pare.",
            "Se eu tivesse que esperar minha vida inteira para experimentar o seu amor, eu o faria. E morrendo após isso ficaria feliz, pois eu teria experimentado o céu antes mesmo de alcançá-lo.",
            "Mesmo em tempos que lembram preto e branco, você continua a brilhar como ouro para mim.",
            "Se eu tivesse uma flor para cada pensamento em você, eu poderia andar pelo meu jardim para a eternidade.",
            "Se eu fosse aprender todas as línguas do mundo, ainda não encontraria as palavras exatas para expressar o quanto te amo.",
            "Se eu tivesse que escolher entre o sol e a lua ou as estrelas, eu escolheria seus olhos como eles brilham mais do que todos eles.",
            "Se minha alma fosse uma caneta e meu coração tinta, com o sangue de minhas veias eu escreveria “eu te amo”.",
            "Por que eu olharia para outras estrelas quando já me apaixonei pela lua?",
            "Quando te conheci percebi que os anjos nunca nos convidariam, porque se vissem a perfeição com que Deus te criou, seu ciúme causaria guerra.",
            "Dizem que a Fossa das Marianas é o lugar mais profundo da terra, mas isso é falso, pois ela não se compara à profundidade do meu amor por você.",
            "Se o sol desaparecesse não faria diferença porque você brilha mais do que qualquer estrela do universo.",
            "Não importa o quão bonito seja o pôr do sol, nada pode comparar sua beleza, pois mesmo que o sol se ponha, seu brilho ainda iluminaria meu mundo.",
            "Se eu tivesse que escolher entre respirar e te amar, daria meu último suspiro para dizer que te amo.",
            "Dizem que a beleza está nos olhos de quem vê, mas com o jeito que você me balança com seu abraço caloroso, até os cegos podem imaginar sua beleza.",
            "Um dia você vai me perguntar quem é a vida mais importante, a sua ou a minha, ao que eu responderei a minha e você irá embora sem saber.",
            "Você roubou meu fôlego, minha atenção, meu coração e meus pensamentos, mas imploro que tire mais de mim, até mesmo meu sobrenome.",
            "Você não tem reflexo meu amor, porque nada neste mundo pode replicar a beleza divina que você possui.",
            "Se você carregasse a maldição da Medusa, eu ainda olharia para seus olhos para que meu corpo de pedra pudesse contemplar a perfeição para a eternidade."
        ];

        let width, height;
        let zoom = 0.45;
        let targetZoom = 0.45;
        let panX = 0, panY = 0;
        let targetPanX = 0, targetPanY = 0;
        
        let isDragging = false;
        let lastMouseX = 0, lastMouseY = 0;

        let initialPinchDistance = null;
        let initialZoom = null;

        const constellations = [];
        const SPREAD = 9000;

        // --- Melhoras nql porqueira ---
        
        // controle de volume
        volumeSlider.addEventListener('input', (e) => {
            bgMusic.volume = e.target.value;
        });

        // ai é um bgl q eu nao sei explicar, mas ta ai KKKKKK (gemini me ajudou nessa, thx brother)
        function updatePlayerUI() {
            if (!bgMusic.paused) {
                playIcon.style.display = 'none';
                pauseIcon.style.display = 'block';
                equalizer.classList.remove('paused');
            } else {
                playIcon.style.display = 'block';
                pauseIcon.style.display = 'none';
                equalizer.classList.add('paused');
            }
        }

        // Sincronia
        bgMusic.addEventListener('play', updatePlayerUI);
        bgMusic.addEventListener('pause', updatePlayerUI);
        bgMusic.addEventListener('ended', () => {
            updatePlayerUI();
        });

        //  butão
        toggleMusicBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            if (bgMusic.paused) {
                bgMusic.play().catch(e => console.error("Erro ao dar play:", e));
            } else {
                bgMusic.pause();
            }
        });

        // Viagem a lua (sqn)
        function startExperience() {
            menu.classList.add('hidden');
            
            // Tenta tocar, só tenta, mas tipo, só tenta msm KKKKKKKKKKK
            const playPromise = bgMusic.play();
            
            if (playPromise !== undefined) {
                playPromise.then(_ => {
                    // gg tropa 
                })
                .catch(error => {
                    console.log("Autoplay bloqueado pelo navegador. O usuário precisa clicar no play.");
                });
            }

            // aquele efeitinho goxtoso
            setTimeout(() => {
                musicPlayer.classList.add('visible');
            }, 1000);

            // outro tesudo
            setTimeout(() => { targetZoom = 0.65; }, 1000);
        }

        // pra iniciar a brincadeira
        startBtn.addEventListener('click', startExperience);
        startBtn.addEventListener('touchend', (e) => {
            e.preventDefault();
            startExperience();
        }, { passive: false });


        // estrelinha e o viado do canvas

        function lerp(start, end, factor) {
            return start + (end - start) * factor;
        }

        function seededRandom(seed) {
            const x = Math.sin(seed++) * 10000;
            return x - Math.floor(x);
        }

        class Constellation {
            constructor(quote, id, type = 'normal') {
                this.quote = quote;
                this.id = id;
                this.type = type; // 'normal', 'sun', 'moon'
                
                if (type === 'sun') {
                    this.worldX = 1200;
                    this.worldY = -800;
                } else if (type === 'moon') {
                    this.worldX = -1500;
                    this.worldY = 1000;
                } else {
                    const r1 = seededRandom(id * 123);
                    const r2 = seededRandom(id * 321);
                    this.worldX = (r1 - 0.5) * SPREAD;
                    this.worldY = (r2 - 0.5) * SPREAD;
                }

                this.stars = [];
                const count = type !== 'normal' ? 1 : (4 + Math.floor(seededRandom(id) * 4));
                for(let i=0; i<count; i++) {
                    const angle = seededRandom(id + i) * Math.PI * 2;
                    const dist = 40 + seededRandom(id + i * 10) * 100;
                    this.stars.push({
                        dx: i === 0 ? 0 : Math.cos(angle) * dist,
                        dy: i === 0 ? 0 : Math.sin(angle) * dist,
                        size: type === 'sun' ? 40 : (type === 'moon' ? 30 : 1.2 + seededRandom(id + i) * 1.8),
                        pulse: seededRandom(id + i) * Math.PI * 2
                    });
                }

                this.el = document.createElement('div');
                this.el.className = 'quote-label';
                
                if (type === 'sun') {
                    this.el.innerHTML = `<span class="celestial-title"></span>${quote}`;
                    this.el.style.color = "#fbbf24";
                } else if (type === 'moon') {
                    this.el.innerHTML = `<span class="celestial-title"></span>${quote}`;
                    this.el.style.color = "#cbd5e1";
                } else {
                    this.el.textContent = quote;
                }
                
                textOverlay.appendChild(this.el);
            }

            draw(ctx, currentZoom, currentPanX, currentPanY) {
                const screenX = width / 2 + (this.worldX + currentPanX) * currentZoom;
                const screenY = height / 2 + (this.worldY + currentPanY) * currentZoom;

                // Otimização
                if (screenX < -600 || screenX > width + 600 || screenY < -600 || screenY > height + 600) {
                    if (this.el.classList.contains('visible')) this.el.classList.remove('visible');
                    return;
                }

                const showLines = currentZoom > 0.5 && this.type === 'normal';
                const showText = currentZoom > 1.05 || (this.type !== 'normal' && currentZoom > 0.5);

                if (showLines) {
                    ctx.beginPath();
                    ctx.strokeStyle = 'rgba(255, 255, 255, 0.08)';
                    ctx.lineWidth = 0.5 * currentZoom;
                    this.stars.forEach((s, i) => {
                        const sx = screenX + s.dx * currentZoom;
                        const sy = screenY + s.dy * currentZoom;
                        if (i === 0) ctx.moveTo(sx, sy);
                        else ctx.lineTo(sx, sy);
                    });
                    ctx.stroke();
                }

                this.stars.forEach((s) => {
                    const sx = screenX + s.dx * currentZoom;
                    const sy = screenY + s.dy * currentZoom;
                    
                    s.pulse += 0.02;
                    const pulseScale = 1 + Math.sin(s.pulse) * (this.type === 'normal' ? 0.2 : 0.05);
                    const size = s.size * Math.max(currentZoom, 0.2) * pulseScale;

                    if (this.type === 'sun') {
                        const grad = ctx.createRadialGradient(sx, sy, 0, sx, sy, size * 2);
                        grad.addColorStop(0, '#fffbe6');
                        grad.addColorStop(0.4, '#fbbf24');
                        grad.addColorStop(1, 'transparent');
                        ctx.fillStyle = grad;
                        ctx.shadowBlur = 40 * currentZoom;
                        ctx.shadowColor = '#fbbf24';
                    } else if (this.type === 'moon') {
                        const grad = ctx.createRadialGradient(sx, sy, 0, sx, sy, size * 1.5);
                        grad.addColorStop(0, '#f8fafc');
                        grad.addColorStop(0.5, '#cbd5e1');
                        grad.addColorStop(1, 'transparent');
                        ctx.fillStyle = grad;
                        ctx.shadowBlur = 20 * currentZoom;
                        ctx.shadowColor = '#cbd5e1';
                    } else {
                        ctx.fillStyle = '#ffffff';
                    }

                    ctx.beginPath();
                    ctx.arc(sx, sy, size, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.shadowBlur = 0;
                });

                if (showText) {
                    const offset = this.type === 'normal' ? 30 : 60;
                    this.el.style.transform = `translate3d(${screenX}px, ${screenY + offset * currentZoom}px, 0) translateX(-50%)`;
                    this.el.classList.add('visible');
                } else {
                    this.el.classList.remove('visible');
                }
            }
        }

        function init() {
            resize();

            const sunQuote = "Eu já presenciei a gloriosa luz de mil sóis, isso foi o suficiente para eu perceber que somente a sua presença faz com que todas aquelas luzes tornem apenas mais algumas partículas de fótons, comparado ao brilho de teu olhar.";
            const moonQuote = "Se eu pudesse pedir para Deus refazer o universo, pediria para Ele substituir você pela lua entre as estrelas, então eu poderia olhar para você todas as noites.";
            
            constellations.push(new Constellation(sunQuote, 888, 'sun'));
            constellations.push(new Constellation(moonQuote, 777, 'moon'));

            QUOTES.forEach((q, i) => {
                if (q !== sunQuote && q !== moonQuote) {
                    constellations.push(new Constellation(q, i));
                }
            });
            
            animate();
        }

        function resize() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
        }

        function animate() {
            zoom = lerp(zoom, targetZoom, 0.04);
            panX = lerp(panX, targetPanX, 0.04);
            panY = lerp(panY, targetPanY, 0.04);

            ctx.fillStyle = '#050510';
            ctx.fillRect(0, 0, width, height);

            // Estrelas de fundo
            ctx.fillStyle = 'rgba(255, 255, 255, 0.1)';
            for(let i=0; i<200; i++) {
                const r1 = seededRandom(i);
                const r2 = seededRandom(i+500);
                const x = (r1 * width + panX * 0.03) % width;
                const y = (r2 * height + panY * 0.03) % height;
                ctx.beginPath();
                ctx.arc(x < 0 ? x + width : x, y < 0 ? y + height : y, 0.5, 0, Math.PI * 2);
                ctx.fill();
            }

            constellations.forEach(c => c.draw(ctx, zoom, panX, panY));

            requestAnimationFrame(animate);
        }

        // mouse e o touch (QUE BAGULHO CHATOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO)

        window.addEventListener('wheel', (e) => {
            targetZoom -= e.deltaY * 0.001;
            targetZoom = Math.min(Math.max(targetZoom, 0.1), 4);
        }, { passive: true });

        // eventos do mouse rs
        window.addEventListener('mousedown', (e) => {
            if (e.target.closest('#music-player') || e.target.closest('#menu-overlay')) return;
            isDragging = true;
            lastMouseX = e.clientX;
            lastMouseY = e.clientY;
            canvas.style.cursor = 'grabbing';
        });

        window.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            targetPanX += (e.clientX - lastMouseX) / zoom;
            targetPanY += (e.clientY - lastMouseY) / zoom;
            lastMouseX = e.clientX;
            lastMouseY = e.clientY;
        });

        window.addEventListener('mouseup', () => {
            isDragging = false;
            canvas.style.cursor = 'grab';
        });

        // exame de prostata (eventos de toque)
        canvas.addEventListener('touchstart', (e) => {
            if (e.target.closest('#music-player')) return;

            if (e.touches.length === 1) {
                isDragging = true;
                lastMouseX = e.touches[0].clientX;
                lastMouseY = e.touches[0].clientY;
            } else if (e.touches.length === 2) {
                isDragging = false;
                const dx = e.touches[0].clientX - e.touches[1].clientX;
                const dy = e.touches[0].clientY - e.touches[1].clientY;
                initialPinchDistance = Math.sqrt(dx * dx + dy * dy);
                initialZoom = targetZoom;
            }
        }, { passive: false });

        canvas.addEventListener('touchmove', (e) => {
            if (e.target.closest('#music-player')) return; // Permite interação com slider se necessário
            e.preventDefault();

            if (e.touches.length === 1 && isDragging) {
                const x = e.touches[0].clientX;
                const y = e.touches[0].clientY;
                targetPanX += (x - lastMouseX) / zoom;
                targetPanY += (y - lastMouseY) / zoom;
                lastMouseX = x;
                lastMouseY = y;
            } else if (e.touches.length === 2 && initialPinchDistance) {
                const dx = e.touches[0].clientX - e.touches[1].clientX;
                const dy = e.touches[0].clientY - e.touches[1].clientY;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                const scale = distance / initialPinchDistance;
                targetZoom = Math.min(Math.max(initialZoom * scale, 0.1), 4);
            }
        }, { passive: false });

        window.addEventListener('touchend', () => {
            isDragging = false;
            initialPinchDistance = null;
        });

        window.addEventListener('resize', resize);

        init();
    </script>
</body>
</html>